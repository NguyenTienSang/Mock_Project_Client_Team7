<div class="content-wrapper">
    <app-content-header [contentHeader]="contentHeader"></app-content-header>
    <div class="row">
      <div class="col-2 d-flex justify-content-start justify-content-md-end">
        <div class="d-flex justify-content-between align-items-center m-1">
          <label class="d-flex align-items-center"
            >Show
            <select class="form-control mx-25" [(ngModel)]="selectedOption">
              <option value="10">10</option>
              <option value="25">25</option>
              <option value="50">50</option>
              <option value="100">100</option>
            </select>
            entries</label
          >
        </div>
      </div>

      <div class="col-6 d-flex justify-content-start justify-content-md-end">
        <div class="d-flex align-items-center justify-content-end pr-1 pb-1 pb-md-0">
          <label  for="startDay" class="ml-1">Start Day</label>
          <input id="startDay" type="date" class="form-control ml-1" placeholder="expire" name="expire" (change)="loadListReport()" [(ngModel)]="startDay" />

          <label  for="endDay" class="ml-1">End Day</label>
          <input id="endDay" type="date" class="form-control ml-1" placeholder="expire" name="expire" (change)="loadListReport()" [(ngModel)]="endDay" />

          <button class="btn btn-primary ml-25" (click)="exportExcel()">
            <!-- <i data-feather="plus" class="d-sm-none d-inline-block mr-0 mr-sm-1"></i> -->
            <span>Report Excel</span>
          </button>

          <button class="btn btn-primary ml-25" (click)="exportPDF()">
            <!-- <i data-feather="plus" ></i> -->
            <span>Report PDF</span>
          </button>

        </div>
      </div>

      <div class="col-4 d-flex justify-content-start justify-content-md-end">
        <div class="d-flex align-items-center justify-content-end pr-1 pb-1 pb-md-0">
          <label class="d-flex align-items-center ml-1 ml-md-0"
            >Search:<input type="search" class="form-control ml-25" (keyup)="filterUpdate($event)"
          /></label>
          <button class="btn btn-primary ml-1" routerLink="/apps/e-commerce/add">
            <i data-feather="plus" class="d-sm-none d-inline-block mr-0 mr-sm-1"></i
            ><span class="d-none d-sm-inline-block">Add New Product</span>
          </button>
        </div>
      </div>
    </div>
    <div class="content-body">
        <ngx-datatable
          [rows]="rows"
          [rowHeight]="60"
          class="bootstrap core-bootstrap"
          [limit]="selectedOption"
          [columnMode]="ColumnMode.force"
          [headerHeight]="50"
          [footerHeight]="50"
          [scrollbarH]="true"
        >
          <ngx-datatable-column name="Product" prop="name" [width]="300">
            <ng-template let-row="row" let-name="value" ngx-datatable-cell-template>
              <div class="d-flex align-items-center">
                <div *ngIf="row.image.length > 0; else customAvatar">
                  <img
                    class="rounded-circle mr-1"
                    src="{{ row.image }}"
                    height="50"
                    width="50"
                    alt="datatable-image"
                  />
                </div>
                <div class="cell-line-height">
                  <a routerLink="/apps/e-commerce/details/{{ row.id }}" class="font-medium-1 d-block"
                    ><span class="font-weight-bold">{{ (name | slice:0:30) + '...'}}
                    </span></a>
                </div>
              </div>
            </ng-template>
          </ngx-datatable-column>
          <ngx-datatable-column name="Description" prop="description" [width]="250">
            <ng-template let-row="row" let-name="value" ngx-datatable-cell-template>
                <div class="cell-line-height">
                      <span>{{ (name | slice:0:40) + '...'}}
                      </span>
                  </div>
              </ng-template>
          </ngx-datatable-column>
          <ngx-datatable-column name="Brand" prop="brand.name" [width]="50">
          </ngx-datatable-column>
          <ngx-datatable-column name="Quantity" prop="quantity" [width]="50">
          </ngx-datatable-column>
          <ngx-datatable-column name="Price" prop="price" [width]="50">
            <ng-template let-price="value" ngx-datatable-cell-template>
                <div>
                  $
                  {{ price }}
                </div>
              </ng-template>
          </ngx-datatable-column>
          <ngx-datatable-column name="Actions" [width]="40" [sortable]="false">
            <ng-template ngx-datatable-cell-template let-row="row">
              <div ngbDropdown container="body">
                <button ngbDropdownToggle type="button" class="btn icon-btn btn-sm hide-arrow" rippleEffect>
                  <span [data-feather]="'more-vertical'" [class]="'cursor-pointer'"></span>
                </button>
                <div ngbDropdownMenu>
                  <a routerLink="/apps/e-commerce/edit/{{ row.id }}" ngbDropdownItem
                    ><span [data-feather]="'edit'" [size]="16" [class]="'mr-50'"></span> Edit</a
                  ><a href="javascript:;" (click)="deleteProduct(row.id)" ngbDropdownItem
                    ><span [data-feather]="'trash'" [size]="16" [class]="'mr-50'"></span> Delete</a
                  >
                </div>
              </div>
            </ng-template>
          </ngx-datatable-column>

        </ngx-datatable>
    </div>
    <core-sidebar
    class="modal modal-slide-in sidebar-todo-modal fade"
    name="new-user-sidebar"
    overlayClass="modal-backdrop"
  >
  </core-sidebar>

  <div hidden id="content" class="content" #content>
    <header width="100" height="5px" style="text-align: center; color: green">
      <h1 class="logo-title">FSHOP</h1>
    </header>

    <hr width="100%"
    size="5px">

    <div style="text-align: center; color: green;font-weight: bold;margin-top:10px;margin-bottom:30px">
        <h1>REPORT PRODUCT</h1>
    </div>

    <h3>Overise</h3>
    <div style="margin-top:10px;margin-bottom:30px">
          <div style="margin:10px;margin-left:40px; font-weight: bold;">Start Day: {{startDay}}</div>
          <div style="margin:10px;margin-left:40px; font-weight: bold;">End Day: {{endDay}}</div>
          <div style="margin:10px;margin-left:40px; font-weight: bold;">Total amount sold: {{totalAmountSold}}</div>
          <div style="margin:10px;margin-left:40px; font-weight: bold;">Total proceeds: {{totalProceeds}}</div>
          <div style="margin:10px;margin-left:40px; font-weight: bold;">Best selling products: <span *ngFor="let item of bestBellingProducts">{{item}} </span></div>
          <div style="margin:10px;margin-left:40px; font-weight: bold;">The product that sells the least: <span *ngFor="let item of productSoldAtLeast">{{item}} </span></div>
    </div>
    <h1 style="margin-top:10px;margin-bottom:30px">Detail</h1>
    <div style="margin:10px 20px 20px 30px">
        <table  style="width:90%;text-align:center;">
            <thead>
              <tr>
                <th style="height: 70px;background-color: rgb(109, 109, 230);color:#FFF;width:5%;text-align:center;">No</th>
                <th style="height: 70px;background-color: rgb(109, 109, 230);color:#FFF;width:5%;text-align:center;">Id</th>
                <th style="height: 70px;background-color: rgb(109, 109, 230);color:#FFF;width:35%;text-align:center;">NameProduct</th>
                <th style="height: 70px;background-color: rgb(109, 109, 230);color:#FFF;width:10%;text-align:center;">Price</th>
                <th style="height: 70px;background-color: rgb(109, 109, 230);color:#FFF;width:10%;text-align:center;">SoldQuantity</th>
                <th style="height: 70px;background-color: rgb(109, 109, 230);color:#FFF;width:10%;text-align:center;">Proceeds</th>
                <th style="height: 70px;background-color: rgb(109, 109, 230);color:#FFF;width:10%;text-align:center;">StorageQuantity</th>
                <th style="height: 70px;background-color: rgb(109, 109, 230);color:#FFF;width:15%;text-align:center;">CreatedDay</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of listReport;let i = index">
                <td style="width:5%;text-align:center;">{{i+1}}</td>
                <td style="width:5%;height:40px;text-align:center;">{{item.productId}}</td>
                <td style="width:35%;height:40px;text-align:center;">{{item.name}}</td>
                <td style="width:10%;height:40px;text-align:center;">{{item.price}}</td>
                <td style="width:10%;height:40px;text-align:center;">{{item.soldQuantity}}</td>
                <td style="width:10%;height:40px;text-align:center;">{{item.proceeds}}</td>
                <td style="width:10%;height:40px;text-align:center;">{{item.storageQuantity}}</td>
                <td style="width:15%;height:40px;text-align:center;">{{item.createdDay}}</td>
              </tr>
            </tbody>
        </table>
    </div>
  </div>

  <table hidden style="top:12px" id="excel-table">
    <tr><td>FSHOP</td></tr>
    <tr></tr>
    <tr></tr>
    <tr><td>Overise</td></tr>
    <tr><td>Start Day:</td><td>{{startDay}}</td></tr>
    <tr><td>End Day:</td><td>{{endDay}}</td></tr>
    <tr><td>Total amount sold:</td><td>{{totalAmountSold}}</td></tr>
    <tr><td>Total proceeds:</td><td>{{totalProceeds}}</td></tr>
    <tr><td>Best selling products:</td><td><span *ngFor="let item of bestBellingProducts">{{item}},</span></td></tr>
    <tr><td>The product that sold at least: </td><td><span *ngFor="let item of productSoldAtLeast">{{item}},</span></td></tr>
    <tr></tr>
    <tr><td>Detail</td></tr>
    <tr>
      <th>ProductId</th>
      <th>Name</th>
      <th>Price</th>
      <th>SoldQuantity</th>
      <th>Proceeds</th>
      <th>StorageQuantity</th>
      <th>CreatedDay</th>
    </tr>
    <tr *ngFor="let item of listReport">
      <td>{{item.productId}}</td>
      <td>{{item.name}}</td>
      <td>{{item.price}}</td>
      <td>{{item.soldQuantity}}</td>
      <td>{{item.proceeds}}/td>
      <td>{{item.storageQuantity}}</td>
      <td>{{item.createdDay}}</td>
    </tr>
  </table>

</div>
<!--/ Ecommerce Wishlist -->
